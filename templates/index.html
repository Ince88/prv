<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRV AI Marketing Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=3">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                            <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
                            <path d="M16 8L22 14L16 20M10 14H20" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <defs>
                                <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32">
                                    <stop offset="0%" stop-color="#9b59b6"/>
                                    <stop offset="100%" stop-color="#3498db"/>
                                </linearGradient>
                            </defs>
                        </svg>
                    </div>
                    <span class="logo-text">PRV AI</span>
                </div>
            </div>
            
            <!-- ASSISTANT SELECTION -->
            <div class="sidebar-section">
                <div class="section-title">Assistant</div>
                <select id="assistant-select" class="assistant-select">
                    {% for name, info in assistants.items() %}
                    <option value="{{ name }}" data-color="{{ info.color }}">{{ name }}</option>
                    {% endfor %}
                </select>
                <div id="assistant-description" class="assistant-description"></div>
            </div>
            
            <!-- EMAIL CONTEXT - NEW SECTION -->
            <div class="sidebar-section" style="background: #f0f9ff; border: 2px solid #3498db; border-radius: 8px; padding: 16px;">
                <div class="section-title" style="color: #3498db;">üìß Email Context</div>
                <button class="sidebar-btn" id="connect-gmail-btn" style="margin-bottom: 10px; background: #27ae60; color: white; font-weight: 600;">
                    üîó Connect Gmail
                </button>
                <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                    <input type="email" id="email-input" class="email-input" placeholder="Enter email address..." style="margin-bottom: 0; flex: 1;">
                    <button onclick="pasteToEmailInput()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; white-space: nowrap;">
                        üìã Paste
                    </button>
                </div>
                <button class="sidebar-btn" id="load-emails-btn" style="margin-bottom: 8px; background: #3498db; color: white;">
                    Load Email History
                </button>
                <button class="sidebar-btn" id="view-emails-btn" style="background: #9b59b6; color: white;">
                    View Emails
                </button>
            </div>
            
            <!-- COMPANY RESEARCH SECTION -->
            <div class="sidebar-section" style="background: #e8f5e9; border: 2px solid #27ae60; border-radius: 8px; padding: 16px;">
                <div class="section-title" style="color: #27ae60;">üîç C√©g Keres√©s</div>
                <button class="sidebar-btn" id="company-research-btn" style="background: #27ae60; color: white;">
                    üè¢ C√©g Inform√°ci√≥
                </button>
            </div>
            
            <!-- SETUP/SETTINGS SECTION -->
            <div class="sidebar-section" id="setup-section">
                <button class="sidebar-btn" id="setup-btn" style="background: #f39c12; color: white;">
                    ‚öôÔ∏è Settings
                </button>
            </div>
            
            <!-- CLEAR BUTTON -->
            <div class="sidebar-section">
                <button class="sidebar-btn" id="clear-chat-btn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M3 6L5 4H11L13 6M13 6V13C13 13.5 12.5 14 12 14H4C3.5 14 3 13.5 3 13V6M6 6V3H10V6"/>
                    </svg>
                    Clear Conversation
                </button>
            </div>
            
            <div class="sidebar-footer">
                <div class="status-indicator" id="status-indicator">
                    <div class="status-dot"></div>
                    <span>Connected</span>
                </div>
            </div>
            
            <!-- Pass config status from Flask -->
            <script>
                window.HAS_OPENAI = {% if has_openai %}true{% else %}false{% endif %};
                window.HAS_GMAIL = {% if has_gmail %}true{% else %}false{% endif %};
                window.CURRENT_USERNAME = {% if username %}{{ username|tojson }}{% else %}null{% endif %};
            </script>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="chat-header">
                <div class="header-info">
                    <h1 class="header-title">AI Marketing Assistant</h1>
                    <p class="header-subtitle">Your intelligent B2B marketing companion</p>
                </div>
            </div>
            
            <!-- Messages Area -->
            <div class="messages-container" id="messages-container">
                <div class="welcome-message">
                    <div class="welcome-icon">üëã</div>
                    <h2>Welcome to PRV AI Marketing Assistant</h2>
                    <p>I'm here to help you with email marketing, sales strategies, and B2B communication.</p>
                    <div class="suggestions">
                        <button class="suggestion-chip" onclick="sendSuggestion('Help me write a follow-up email')">
                            Write follow-up email
                        </button>
                        <button class="suggestion-chip" onclick="sendSuggestion('How do I handle price objections?')">
                            Handle objections
                        </button>
                        <button class="suggestion-chip" onclick="sendSuggestion('Create a cold email template')">
                            Cold email template
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Input Area -->
            <div class="input-area">
                <div class="input-container">
                    <textarea 
                        id="message-input" 
                        class="message-input" 
                        placeholder="Type your message here..."
                        rows="1"></textarea>
                    <button id="send-btn" class="send-btn">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M18 2L9 11M18 2L12 18L9 11M18 2L2 8L9 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                <div class="input-hint">Press Ctrl+Enter to send</div>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/app.js') }}?v=13"></script>
</body>
</html>

